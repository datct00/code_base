INFO: set random seed: 1111
INFO: Using device : cuda
	GPU ID is [0],using 1 device
	device name:NVIDIA GeForce RTX 4060 Ti
INFO: ============ Start  train ==============
INFO: Creating total train dataset with 13598 examples
INFO: Creating factual train dataset with 13598 examples
INFO: Creating total val dataset with 3626 examples
INFO: Creating factual val dataset with 3626 examples
INFO: Creating total val_3d dataset with 8060 examples
INFO: Creating factual val_3d dataset with 8060 examples
INFO: Train Data: Labeled data is: <1359>, Total data is: 13598
INFO: Starting training:
	start_time:     2025-10-17 17:14:04
	base_dir:       res-t2_t1ce-FullCMC-BraTs-seed-2-CMC-10%_seed_1111
	data_path:      A:\Dat\semi-CML-public\dataset\BraTS_slice
	train_list:     randP1_slice_nidus_train.list
	val_list:       randP1_slice_nidus_val.list
	img_mode:       t2_t1ce
	lr_scheduler:   warmupMultistep
	max_epoch:      81
	batch_size:     24
	labeled_bs:     20
	labeled_rate:   0.1
	unsup_epoch:    0
	images_rate:    1
	base_lr:        0.006
	step_num_lr:    4
	weight_decay:   0.0004
	optim_name:     adam
	loss_name:      bce
	bce_w:          10.0
	dice_w:         7.0
	consistency:    1.0
	cons_ramp_type: sig_ram
	nce_weight:     3.5
	sur_siml:       dice
	pHead_sur:      set_false
	M2_epoch:       51
	T_epoch:        10
	T_num:          4
	bma_update_pool_num:6
	M2_epoch_all:   0
	m1_alpha:       0.1
	m2_alpha:       0.1
	teach_m2_WP_epoch:3
	start_fusion_epoch:30
	will_eval:      0
	val_3d_interval:4
	Net Name:		CMCNet
	Input Channel:	1
	Classes Num:	1
	Images Shape:	160*160
INFO: Epoch:[000/081], Train Loss: 1.2242 , Sup Loss 1.2242, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.5532 mode2 0.4013 ,LR: 0.001500
INFO: Epoch:[001/081], Train Loss: 1.0814 , Sup Loss 1.0814, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6230 mode2 0.5300 ,LR: 0.002250
INFO: Epoch:[002/081], Train Loss: 1.0389 , Sup Loss 1.0389, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6484 mode2 0.5058 ,LR: 0.003000
INFO: Epoch:[003/081], Train Loss: 1.0393 , Sup Loss 1.0393, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6466 mode2 0.4663 ,LR: 0.003750
INFO: Epoch:[004/081], Train Loss: 1.0310 , Sup Loss 1.0310, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6521 mode2 0.4875 ,LR: 0.004500
INFO: Epoch:[005/081], Train Loss: 1.0403 , Sup Loss 1.0403, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6422 mode2 0.4592 ,LR: 0.005250
INFO: Epoch:[006/081], Train Loss: 1.0293 , Sup Loss 1.0293, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6618 mode2 0.4643 ,LR: 0.006000
INFO: Epoch:[007/081], Train Loss: 1.0709 , Sup Loss 1.0709, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.5912 mode2 0.4012 ,LR: 0.006000
INFO: Epoch:[008/081], Train Loss: 1.0374 , Sup Loss 1.0374, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6403 mode2 0.4706 ,LR: 0.006000
INFO: Epoch:[009/081], Train Loss: 1.0159 , Sup Loss 1.0159, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6733 mode2 0.4979 ,LR: 0.006000
INFO: Epoch:[010/081], Train Loss: 1.0058 , Sup Loss 1.0058, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6874 mode2 0.5310 ,LR: 0.006000
INFO: Epoch:[011/081], Train Loss: 1.0053 , Sup Loss 1.0053, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.6839 mode2 0.5518 ,LR: 0.000600
INFO: Epoch:[012/081], Train Loss: 0.9878 , Sup Loss 0.9878, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7112 mode2 0.5908 ,LR: 0.000600
INFO: Epoch:[013/081], Train Loss: 0.9732 , Sup Loss 0.9732, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7327 mode2 0.6042 ,LR: 0.000600
INFO: Epoch:[014/081], Train Loss: 0.9669 , Sup Loss 0.9669, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7409 mode2 0.6224 ,LR: 0.000600
INFO: Epoch:[015/081], Train Loss: 0.9668 , Sup Loss 0.9668, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7415 mode2 0.6228 ,LR: 0.000600
INFO: Epoch:[016/081], Train Loss: 0.9615 , Sup Loss 0.9615, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7496 mode2 0.6288 ,LR: 0.000600
INFO: Epoch:[017/081], Train Loss: 0.9560 , Sup Loss 0.9560, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7593 mode2 0.6459 ,LR: 0.000600
INFO: Epoch:[018/081], Train Loss: 0.9543 , Sup Loss 0.9543, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7621 mode2 0.6488 ,LR: 0.000600
INFO: Epoch:[019/081], Train Loss: 0.9506 , Sup Loss 0.9506, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7677 mode2 0.6517 ,LR: 0.000600
INFO: Epoch:[020/081], Train Loss: 0.9513 , Sup Loss 0.9513, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7669 mode2 0.6500 ,LR: 0.000600
INFO: Epoch:[021/081], Train Loss: 0.9521 , Sup Loss 0.9521, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7652 mode2 0.6572 ,LR: 0.000600
INFO: Epoch:[022/081], Train Loss: 0.9443 , Sup Loss 0.9443, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7791 mode2 0.6634 ,LR: 0.000600
INFO: Epoch:[023/081], Train Loss: 0.9443 , Sup Loss 0.9443, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7809 mode2 0.6589 ,LR: 0.000600
INFO: Epoch:[024/081], Train Loss: 0.9433 , Sup Loss 0.9433, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7831 mode2 0.6644 ,LR: 0.000600
INFO: Epoch:[025/081], Train Loss: 0.9424 , Sup Loss 0.9424, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7833 mode2 0.6681 ,LR: 0.000600
INFO: Epoch:[026/081], Train Loss: 0.9384 , Sup Loss 0.9384, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7889 mode2 0.6727 ,LR: 0.000600
INFO: Epoch:[027/081], Train Loss: 0.9363 , Sup Loss 0.9363, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.7938 mode2 0.6769 ,LR: 0.000060
INFO: Epoch:[028/081], Train Loss: 0.9301 , Sup Loss 0.9301, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.8054 mode2 0.6945 ,LR: 0.000060
INFO: Epoch:[029/081], Train Loss: 0.9264 , Sup Loss 0.9264, CSC_Loss 0.0000, CAC_loss 0.0000 , Train Dice: mode1 0.8109 mode2 0.6986 ,LR: 0.000060
INFO: Epoch:[030/081], Train Loss: 1.6724 , Sup Loss 0.9271, CSC_Loss 5.2941, CAC_loss 0.0229 , Train Dice: mode1 0.8143 mode2 0.6850 ,LR: 0.000060
INFO: Epoch:[031/081], Train Loss: 1.7271 , Sup Loss 0.9266, CSC_Loss 5.2940, CAC_loss 0.0187 , Train Dice: mode1 0.8171 mode2 0.6771 ,LR: 0.000060
INFO: Epoch:[032/081], Train Loss: 1.7872 , Sup Loss 0.9260, CSC_Loss 5.2940, CAC_loss 0.0177 , Train Dice: mode1 0.8183 mode2 0.6746 ,LR: 0.000060
INFO: Epoch:[033/081], Train Loss: 1.8516 , Sup Loss 0.9262, CSC_Loss 5.2940, CAC_loss 0.0167 , Train Dice: mode1 0.8179 mode2 0.6720 ,LR: 0.000060
INFO: Epoch:[034/081], Train Loss: 1.9187 , Sup Loss 0.9258, CSC_Loss 5.2940, CAC_loss 0.0154 , Train Dice: mode1 0.8189 mode2 0.6789 ,LR: 0.000060
INFO: Epoch:[035/081], Train Loss: 1.9897 , Sup Loss 0.9249, CSC_Loss 5.2940, CAC_loss 0.0153 , Train Dice: mode1 0.8193 mode2 0.6801 ,LR: 0.000060
INFO: Epoch:[036/081], Train Loss: 2.0641 , Sup Loss 0.9238, CSC_Loss 5.2939, CAC_loss 0.0154 , Train Dice: mode1 0.8231 mode2 0.6826 ,LR: 0.000060
INFO: Epoch:[037/081], Train Loss: 2.1396 , Sup Loss 0.9211, CSC_Loss 5.2939, CAC_loss 0.0139 , Train Dice: mode1 0.8278 mode2 0.6861 ,LR: 0.000060
INFO: Epoch:[038/081], Train Loss: 2.2226 , Sup Loss 0.9219, CSC_Loss 5.2939, CAC_loss 0.0129 , Train Dice: mode1 0.8263 mode2 0.6803 ,LR: 0.000060
INFO: Epoch:[039/081], Train Loss: 2.3079 , Sup Loss 0.9215, CSC_Loss 5.2939, CAC_loss 0.0117 , Train Dice: mode1 0.8277 mode2 0.6865 ,LR: 0.000060
INFO: Epoch:[040/081], Train Loss: 2.3961 , Sup Loss 0.9199, CSC_Loss 5.2939, CAC_loss 0.0115 , Train Dice: mode1 0.8293 mode2 0.6862 ,LR: 0.000060
INFO: Epoch:[041/081], Train Loss: 2.4887 , Sup Loss 0.9199, CSC_Loss 5.2939, CAC_loss 0.0098 , Train Dice: mode1 0.8312 mode2 0.6825 ,LR: 0.000060
INFO: Epoch:[042/081], Train Loss: 2.5836 , Sup Loss 0.9198, CSC_Loss 5.2939, CAC_loss 0.0060 , Train Dice: mode1 0.8310 mode2 0.6885 ,LR: 0.000060
INFO: Epoch:[043/081], Train Loss: 2.6852 , Sup Loss 0.9210, CSC_Loss 5.2939, CAC_loss 0.0061 , Train Dice: mode1 0.8298 mode2 0.6841 ,LR: 0.000006
INFO: Epoch:[044/081], Train Loss: 2.7846 , Sup Loss 0.9174, CSC_Loss 5.2939, CAC_loss 0.0050 , Train Dice: mode1 0.8349 mode2 0.6891 ,LR: 0.000006
INFO: Epoch:[045/081], Train Loss: 2.8923 , Sup Loss 0.9184, CSC_Loss 5.2939, CAC_loss 0.0052 , Train Dice: mode1 0.8335 mode2 0.6880 ,LR: 0.000006
INFO: Epoch:[046/081], Train Loss: 2.9995 , Sup Loss 0.9160, CSC_Loss 5.2939, CAC_loss 0.0053 , Train Dice: mode1 0.8363 mode2 0.6954 ,LR: 0.000006
INFO: Epoch:[047/081], Train Loss: 3.1129 , Sup Loss 0.9177, CSC_Loss 5.2939, CAC_loss 0.0041 , Train Dice: mode1 0.8343 mode2 0.6901 ,LR: 0.000006
INFO: Epoch:[048/081], Train Loss: 3.2263 , Sup Loss 0.9159, CSC_Loss 5.2939, CAC_loss 0.0049 , Train Dice: mode1 0.8371 mode2 0.6919 ,LR: 0.000006
INFO: Epoch:[049/081], Train Loss: 3.3452 , Sup Loss 0.9174, CSC_Loss 5.2939, CAC_loss 0.0057 , Train Dice: mode1 0.8352 mode2 0.6938 ,LR: 0.000006
INFO: Epoch:[050/081], Train Loss: 3.4628 , Sup Loss 0.9162, CSC_Loss 5.2939, CAC_loss 0.0046 , Train Dice: mode1 0.8364 mode2 0.6940 ,LR: 0.000006
INFO: Epoch:[051/081], Train Loss: 3.5829 , Sup Loss 0.9156, CSC_Loss 5.2939, CAC_loss 0.0036 , Train Dice: mode1 0.8377 mode2 0.6927 ,LR: 0.000006
INFO: Epoch:[052/081], Train Loss: 3.7058 , Sup Loss 0.9153, CSC_Loss 5.2939, CAC_loss 0.0055 , Train Dice: mode1 0.8390 mode2 0.6981 ,LR: 0.000006
INFO: Epoch:[053/081], Train Loss: 3.8290 , Sup Loss 0.9154, CSC_Loss 5.2939, CAC_loss 0.0033 , Train Dice: mode1 0.8390 mode2 0.6972 ,LR: 0.000006
INFO: Epoch:[054/081], Train Loss: 3.9538 , Sup Loss 0.9154, CSC_Loss 5.2939, CAC_loss 0.0040 , Train Dice: mode1 0.8368 mode2 0.6988 ,LR: 0.000006
INFO: Epoch:[055/081], Train Loss: 4.0783 , Sup Loss 0.9145, CSC_Loss 5.2939, CAC_loss 0.0051 , Train Dice: mode1 0.8385 mode2 0.6994 ,LR: 0.000001
INFO: Epoch:[056/081], Train Loss: 4.2041 , Sup Loss 0.9152, CSC_Loss 5.2939, CAC_loss 0.0048 , Train Dice: mode1 0.8395 mode2 0.6972 ,LR: 0.000001
INFO: Epoch:[057/081], Train Loss: 4.3284 , Sup Loss 0.9147, CSC_Loss 5.2939, CAC_loss 0.0035 , Train Dice: mode1 0.8392 mode2 0.7040 ,LR: 0.000001
INFO: Epoch:[058/081], Train Loss: 4.4532 , Sup Loss 0.9149, CSC_Loss 5.2939, CAC_loss 0.0043 , Train Dice: mode1 0.8382 mode2 0.6996 ,LR: 0.000001
INFO: Epoch:[059/081], Train Loss: 4.5769 , Sup Loss 0.9152, CSC_Loss 5.2939, CAC_loss 0.0047 , Train Dice: mode1 0.8366 mode2 0.6989 ,LR: 0.000001
INFO: Epoch:[060/081], Train Loss: 4.6987 , Sup Loss 0.9153, CSC_Loss 5.2939, CAC_loss 0.0038 , Train Dice: mode1 0.8375 mode2 0.6999 ,LR: 0.000001
INFO: Epoch:[061/081], Train Loss: 4.8179 , Sup Loss 0.9142, CSC_Loss 5.2939, CAC_loss 0.0056 , Train Dice: mode1 0.8401 mode2 0.7072 ,LR: 0.000001
INFO: Epoch:[062/081], Train Loss: 4.9368 , Sup Loss 0.9152, CSC_Loss 5.2939, CAC_loss 0.0075 , Train Dice: mode1 0.8377 mode2 0.6993 ,LR: 0.000001
INFO: Epoch:[063/081], Train Loss: 5.0520 , Sup Loss 0.9157, CSC_Loss 5.2939, CAC_loss 0.0064 , Train Dice: mode1 0.8370 mode2 0.7008 ,LR: 0.000001
INFO: Epoch:[064/081], Train Loss: 5.1638 , Sup Loss 0.9156, CSC_Loss 5.2939, CAC_loss 0.0076 , Train Dice: mode1 0.8383 mode2 0.7023 ,LR: 0.000001
INFO: Epoch:[065/081], Train Loss: 5.2709 , Sup Loss 0.9147, CSC_Loss 5.2939, CAC_loss 0.0066 , Train Dice: mode1 0.8383 mode2 0.7069 ,LR: 0.000001
INFO: Epoch:[066/081], Train Loss: 5.3760 , Sup Loss 0.9157, CSC_Loss 5.2939, CAC_loss 0.0070 , Train Dice: mode1 0.8384 mode2 0.6994 ,LR: 0.000001
INFO: Epoch:[067/081], Train Loss: 5.4743 , Sup Loss 0.9145, CSC_Loss 5.2938, CAC_loss 0.0064 , Train Dice: mode1 0.8379 mode2 0.7069 ,LR: 0.000001
INFO: Epoch:[068/081], Train Loss: 5.5685 , Sup Loss 0.9140, CSC_Loss 5.2939, CAC_loss 0.0071 , Train Dice: mode1 0.8386 mode2 0.7083 ,LR: 0.000001
INFO: Epoch:[069/081], Train Loss: 5.6592 , Sup Loss 0.9151, CSC_Loss 5.2939, CAC_loss 0.0076 , Train Dice: mode1 0.8378 mode2 0.7097 ,LR: 0.000001
INFO: Epoch:[070/081], Train Loss: 5.7420 , Sup Loss 0.9141, CSC_Loss 5.2939, CAC_loss 0.0091 , Train Dice: mode1 0.8390 mode2 0.7063 ,LR: 0.000001
INFO: Epoch:[071/081], Train Loss: 5.8207 , Sup Loss 0.9150, CSC_Loss 5.2939, CAC_loss 0.0071 , Train Dice: mode1 0.8382 mode2 0.7058 ,LR: 0.000001
INFO: Epoch:[072/081], Train Loss: 5.8925 , Sup Loss 0.9153, CSC_Loss 5.2939, CAC_loss 0.0064 , Train Dice: mode1 0.8364 mode2 0.7070 ,LR: 0.000001
INFO: Epoch:[073/081], Train Loss: 5.9565 , Sup Loss 0.9144, CSC_Loss 5.2939, CAC_loss 0.0083 , Train Dice: mode1 0.8388 mode2 0.7059 ,LR: 0.000001
INFO: Epoch:[074/081], Train Loss: 6.0143 , Sup Loss 0.9143, CSC_Loss 5.2939, CAC_loss 0.0082 , Train Dice: mode1 0.8390 mode2 0.7099 ,LR: 0.000001
INFO: Epoch:[075/081], Train Loss: 6.0654 , Sup Loss 0.9146, CSC_Loss 5.2939, CAC_loss 0.0084 , Train Dice: mode1 0.8389 mode2 0.7072 ,LR: 0.000001
INFO: Epoch:[076/081], Train Loss: 6.1089 , Sup Loss 0.9148, CSC_Loss 5.2938, CAC_loss 0.0080 , Train Dice: mode1 0.8386 mode2 0.7063 ,LR: 0.000001
INFO: Epoch:[077/081], Train Loss: 6.1455 , Sup Loss 0.9157, CSC_Loss 5.2939, CAC_loss 0.0078 , Train Dice: mode1 0.8378 mode2 0.7092 ,LR: 0.000001
INFO: Epoch:[078/081], Train Loss: 6.1712 , Sup Loss 0.9135, CSC_Loss 5.2939, CAC_loss 0.0054 , Train Dice: mode1 0.8409 mode2 0.7131 ,LR: 0.000001
INFO: Epoch:[079/081], Train Loss: 6.1921 , Sup Loss 0.9143, CSC_Loss 5.2939, CAC_loss 0.0064 , Train Dice: mode1 0.8381 mode2 0.7090 ,LR: 0.000001
INFO: Epoch:[080/081], Train Loss: 6.2038 , Sup Loss 0.9140, CSC_Loss 5.2939, CAC_loss 0.0091 , Train Dice: mode1 0.8381 mode2 0.7121 ,LR: 0.000001
INFO: Model saved !
INFO: Train finished time: 2025-10-17 19:12:19
INFO: Time consuming : 118.25 min in train and test
