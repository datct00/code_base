INFO: set random seed: 1111
INFO: Using device : cuda
	GPU ID is [7],using 1 device
	device name:NVIDIA GeForce RTX 4090
INFO: ============ Start  train ==============
INFO: Creating total train dataset with 13598 examples
INFO: Creating factual train dataset with 13598 examples
INFO: Creating total val dataset with 3626 examples
INFO: Creating factual val dataset with 3626 examples
INFO: Creating total val_3d dataset with 8060 examples
INFO: Creating factual val_3d dataset with 8060 examples
INFO: Train Data: Labeled data is: <1359>, Total data is: 13598
INFO: Starting training:
	start_time:     2025-08-22 21:10:56
	base_dir:       res-t2_t1ce-BraTs-seed-2-OnlySupCMCNet-10%_seed_1111
	data_path:      /mnt/HDD2/dat/med/semi-CML-public/dataset/BraTS_slice
	train_list:     randP1_slice_nidus_train.list
	val_list:       randP1_slice_nidus_val.list
	img_mode:       t2_t1ce
	lr_scheduler:   warmupMultistep
	max_epoch:      81
	batch_size:     24
	labeled_bs:     20
	labeled_rate:   0.1
	unsup_epoch:    0
	images_rate:    1
	base_lr:        0.006
	step_num_lr:    4
	weight_decay:   0.0004
	optim_name:     adam
	loss_name:      bce
	bce_w:          10.0
	dice_w:         7.0
	consistency:    1.0
	cons_ramp_type: sig_ram
	nce_weight:     3.5
	sur_siml:       dice
	pHead_sur:      set_false
	M2_epoch:       51
	T_epoch:        10
	T_num:          4
	bma_update_pool_num:6
	M2_epoch_all:   0
	m1_alpha:       0.1
	m2_alpha:       0.1
	teach_m2_WP_epoch:3
	start_fusion_epoch:82
	will_eval:      1
	val_3d_interval:4
	Net Name:		CMCNet
	Input Channel:	1
	Classes Num:	1
	Images Shape:	160*160
INFO: valid_dice_m1_3d:0.5445,valid_dice_m2_3d:0.3404
INFO: Epoch:[000/081], Train Loss: 1.2603 , Sup Loss 1.2603 , Val Loss: 1.3421, Train Dice: mode1 0.5181 mode2 0.3037 ,LR: 0.001500
INFO: Epoch:[001/081], Train Loss: 1.1160 , Sup Loss 1.1160 , Val Loss: 1.1511, Train Dice: mode1 0.5916 mode2 0.3732 ,LR: 0.002250
INFO: Epoch:[002/081], Train Loss: 1.0674 , Sup Loss 1.0674 , Val Loss: 1.1046, Train Dice: mode1 0.6139 mode2 0.3621 ,LR: 0.003000
INFO: Epoch:[003/081], Train Loss: 1.0568 , Sup Loss 1.0568 , Val Loss: 1.1029, Train Dice: mode1 0.6270 mode2 0.3540 ,LR: 0.003750
INFO: valid_dice_m1_3d:0.1781,valid_dice_m2_3d:0.1145
INFO: Epoch:[004/081], Train Loss: 1.0607 , Sup Loss 1.0607 , Val Loss: 1.3288, Train Dice: mode1 0.6189 mode2 0.3363 ,LR: 0.004500
INFO: Epoch:[005/081], Train Loss: 1.0581 , Sup Loss 1.0581 , Val Loss: 1.1336, Train Dice: mode1 0.6228 mode2 0.3586 ,LR: 0.005250
INFO: Epoch:[006/081], Train Loss: 1.0468 , Sup Loss 1.0468 , Val Loss: 1.1557, Train Dice: mode1 0.6447 mode2 0.3385 ,LR: 0.006000
INFO: Epoch:[007/081], Train Loss: 1.0344 , Sup Loss 1.0344 , Val Loss: 1.9658, Train Dice: mode1 0.6501 mode2 0.3915 ,LR: 0.006000
INFO: valid_dice_m1_3d:0.4825,valid_dice_m2_3d:0.1850
INFO: Epoch:[008/081], Train Loss: 1.0362 , Sup Loss 1.0362 , Val Loss: 1.2114, Train Dice: mode1 0.6509 mode2 0.3949 ,LR: 0.006000
INFO: Epoch:[009/081], Train Loss: 1.0260 , Sup Loss 1.0260 , Val Loss: 1.2382, Train Dice: mode1 0.6600 mode2 0.4173 ,LR: 0.006000
INFO: Epoch:[010/081], Train Loss: 1.0258 , Sup Loss 1.0258 , Val Loss: 1.3095, Train Dice: mode1 0.6614 mode2 0.4201 ,LR: 0.006000
INFO: Epoch:[011/081], Train Loss: 1.0146 , Sup Loss 1.0146 , Val Loss: 1.1643, Train Dice: mode1 0.6752 mode2 0.4677 ,LR: 0.000600
INFO: valid_dice_m1_3d:0.6576,valid_dice_m2_3d:0.4884
INFO: Epoch:[012/081], Train Loss: 0.9873 , Sup Loss 0.9873 , Val Loss: 1.1121, Train Dice: mode1 0.7147 mode2 0.4928 ,LR: 0.000600
INFO: Epoch:[013/081], Train Loss: 0.9736 , Sup Loss 0.9736 , Val Loss: 1.0979, Train Dice: mode1 0.7359 mode2 0.5480 ,LR: 0.000600
INFO: Epoch:[014/081], Train Loss: 0.9679 , Sup Loss 0.9679 , Val Loss: 1.1056, Train Dice: mode1 0.7433 mode2 0.5627 ,LR: 0.000600
INFO: Epoch:[015/081], Train Loss: 0.9674 , Sup Loss 0.9674 , Val Loss: 1.0681, Train Dice: mode1 0.7452 mode2 0.5702 ,LR: 0.000600
INFO: valid_dice_m1_3d:0.6686,valid_dice_m2_3d:0.5507
INFO: Epoch:[016/081], Train Loss: 0.9627 , Sup Loss 0.9627 , Val Loss: 1.1020, Train Dice: mode1 0.7508 mode2 0.5910 ,LR: 0.000600
INFO: Epoch:[017/081], Train Loss: 0.9567 , Sup Loss 0.9567 , Val Loss: 1.1127, Train Dice: mode1 0.7612 mode2 0.6039 ,LR: 0.000600
INFO: Epoch:[018/081], Train Loss: 0.9552 , Sup Loss 0.9552 , Val Loss: 1.0750, Train Dice: mode1 0.7626 mode2 0.6159 ,LR: 0.000600
INFO: Epoch:[019/081], Train Loss: 0.9497 , Sup Loss 0.9497 , Val Loss: 1.0999, Train Dice: mode1 0.7680 mode2 0.6279 ,LR: 0.000600
INFO: valid_dice_m1_3d:0.5803,valid_dice_m2_3d:0.5234
INFO: Epoch:[020/081], Train Loss: 0.9485 , Sup Loss 0.9485 , Val Loss: 1.1529, Train Dice: mode1 0.7731 mode2 0.6287 ,LR: 0.000600
INFO: Epoch:[021/081], Train Loss: 0.9474 , Sup Loss 0.9474 , Val Loss: 1.1165, Train Dice: mode1 0.7736 mode2 0.6330 ,LR: 0.000600
INFO: Epoch:[022/081], Train Loss: 0.9465 , Sup Loss 0.9465 , Val Loss: 1.1014, Train Dice: mode1 0.7714 mode2 0.6468 ,LR: 0.000600
INFO: Epoch:[023/081], Train Loss: 0.9437 , Sup Loss 0.9437 , Val Loss: 1.1261, Train Dice: mode1 0.7777 mode2 0.6557 ,LR: 0.000600
INFO: valid_dice_m1_3d:0.6126,valid_dice_m2_3d:0.5379
INFO: Epoch:[024/081], Train Loss: 0.9441 , Sup Loss 0.9441 , Val Loss: 1.1425, Train Dice: mode1 0.7742 mode2 0.6589 ,LR: 0.000600
INFO: Epoch:[025/081], Train Loss: 0.9423 , Sup Loss 0.9423 , Val Loss: 1.0761, Train Dice: mode1 0.7782 mode2 0.6637 ,LR: 0.000600
INFO: Epoch:[026/081], Train Loss: 0.9401 , Sup Loss 0.9401 , Val Loss: 1.0851, Train Dice: mode1 0.7815 mode2 0.6697 ,LR: 0.000600
INFO: Epoch:[027/081], Train Loss: 0.9348 , Sup Loss 0.9348 , Val Loss: 1.0607, Train Dice: mode1 0.7924 mode2 0.6803 ,LR: 0.000060
INFO: valid_dice_m1_3d:0.6798,valid_dice_m2_3d:0.5935
INFO: Epoch:[028/081], Train Loss: 0.9282 , Sup Loss 0.9282 , Val Loss: 1.1043, Train Dice: mode1 0.8003 mode2 0.6956 ,LR: 0.000060
INFO: Epoch:[029/081], Train Loss: 0.9233 , Sup Loss 0.9233 , Val Loss: 1.1004, Train Dice: mode1 0.8094 mode2 0.7114 ,LR: 0.000060
INFO: Epoch:[030/081], Train Loss: 0.9218 , Sup Loss 0.9218 , Val Loss: 1.1010, Train Dice: mode1 0.8122 mode2 0.7172 ,LR: 0.000060
INFO: Epoch:[031/081], Train Loss: 0.9196 , Sup Loss 0.9196 , Val Loss: 1.1005, Train Dice: mode1 0.8171 mode2 0.7186 ,LR: 0.000060
INFO: valid_dice_m1_3d:0.6888,valid_dice_m2_3d:0.5876
INFO: Epoch:[032/081], Train Loss: 0.9181 , Sup Loss 0.9181 , Val Loss: 1.1043, Train Dice: mode1 0.8190 mode2 0.7244 ,LR: 0.000060
INFO: Epoch:[033/081], Train Loss: 0.9193 , Sup Loss 0.9193 , Val Loss: 1.1027, Train Dice: mode1 0.8163 mode2 0.7227 ,LR: 0.000060
INFO: Epoch:[034/081], Train Loss: 0.9188 , Sup Loss 0.9188 , Val Loss: 1.0918, Train Dice: mode1 0.8152 mode2 0.7222 ,LR: 0.000060
INFO: Epoch:[035/081], Train Loss: 0.9175 , Sup Loss 0.9175 , Val Loss: 1.0986, Train Dice: mode1 0.8187 mode2 0.7315 ,LR: 0.000060
INFO: valid_dice_m1_3d:0.6884,valid_dice_m2_3d:0.5743
INFO: Epoch:[036/081], Train Loss: 0.9163 , Sup Loss 0.9163 , Val Loss: 1.1097, Train Dice: mode1 0.8206 mode2 0.7338 ,LR: 0.000060
INFO: Epoch:[037/081], Train Loss: 0.9148 , Sup Loss 0.9148 , Val Loss: 1.1007, Train Dice: mode1 0.8238 mode2 0.7387 ,LR: 0.000060
INFO: Epoch:[038/081], Train Loss: 0.9142 , Sup Loss 0.9142 , Val Loss: 1.1029, Train Dice: mode1 0.8241 mode2 0.7371 ,LR: 0.000060
INFO: Epoch:[039/081], Train Loss: 0.9137 , Sup Loss 0.9137 , Val Loss: 1.1030, Train Dice: mode1 0.8252 mode2 0.7404 ,LR: 0.000060
INFO: valid_dice_m1_3d:0.7085,valid_dice_m2_3d:0.5708
INFO: Epoch:[040/081], Train Loss: 0.9129 , Sup Loss 0.9129 , Val Loss: 1.1001, Train Dice: mode1 0.8260 mode2 0.7414 ,LR: 0.000060
INFO: Epoch:[041/081], Train Loss: 0.9126 , Sup Loss 0.9126 , Val Loss: 1.1030, Train Dice: mode1 0.8273 mode2 0.7477 ,LR: 0.000060
INFO: Epoch:[042/081], Train Loss: 0.9123 , Sup Loss 0.9123 , Val Loss: 1.1005, Train Dice: mode1 0.8291 mode2 0.7480 ,LR: 0.000060
INFO: Epoch:[043/081], Train Loss: 0.9121 , Sup Loss 0.9121 , Val Loss: 1.1036, Train Dice: mode1 0.8275 mode2 0.7508 ,LR: 0.000006
INFO: valid_dice_m1_3d:0.6834,valid_dice_m2_3d:0.5802
INFO: Epoch:[044/081], Train Loss: 0.9099 , Sup Loss 0.9099 , Val Loss: 1.1126, Train Dice: mode1 0.8307 mode2 0.7508 ,LR: 0.000006
INFO: Epoch:[045/081], Train Loss: 0.9100 , Sup Loss 0.9100 , Val Loss: 1.1104, Train Dice: mode1 0.8321 mode2 0.7502 ,LR: 0.000006
INFO: Epoch:[046/081], Train Loss: 0.9082 , Sup Loss 0.9082 , Val Loss: 1.1026, Train Dice: mode1 0.8351 mode2 0.7577 ,LR: 0.000006
INFO: Epoch:[047/081], Train Loss: 0.9097 , Sup Loss 0.9097 , Val Loss: 1.1088, Train Dice: mode1 0.8323 mode2 0.7540 ,LR: 0.000006
INFO: valid_dice_m1_3d:0.6930,valid_dice_m2_3d:0.5787
INFO: Epoch:[048/081], Train Loss: 0.9083 , Sup Loss 0.9083 , Val Loss: 1.1104, Train Dice: mode1 0.8339 mode2 0.7604 ,LR: 0.000006
INFO: Epoch:[049/081], Train Loss: 0.9100 , Sup Loss 0.9100 , Val Loss: 1.1001, Train Dice: mode1 0.8311 mode2 0.7547 ,LR: 0.000006
INFO: Epoch:[050/081], Train Loss: 0.9087 , Sup Loss 0.9087 , Val Loss: 1.1072, Train Dice: mode1 0.8331 mode2 0.7564 ,LR: 0.000006
INFO: Epoch:[051/081], Train Loss: 0.9080 , Sup Loss 0.9080 , Val Loss: 1.1055, Train Dice: mode1 0.8360 mode2 0.7590 ,LR: 0.000006
INFO: valid_dice_m1_3d:0.6909,valid_dice_m2_3d:0.5770
INFO: Epoch:[052/081], Train Loss: 0.9080 , Sup Loss 0.9080 , Val Loss: 1.1113, Train Dice: mode1 0.8335 mode2 0.7596 ,LR: 0.000006
INFO: Epoch:[053/081], Train Loss: 0.9077 , Sup Loss 0.9077 , Val Loss: 1.1062, Train Dice: mode1 0.8347 mode2 0.7581 ,LR: 0.000006
INFO: Epoch:[054/081], Train Loss: 0.9083 , Sup Loss 0.9083 , Val Loss: 1.1009, Train Dice: mode1 0.8338 mode2 0.7604 ,LR: 0.000006
INFO: Epoch:[055/081], Train Loss: 0.9079 , Sup Loss 0.9079 , Val Loss: 1.1069, Train Dice: mode1 0.8353 mode2 0.7607 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6976,valid_dice_m2_3d:0.5801
INFO: Epoch:[056/081], Train Loss: 0.9075 , Sup Loss 0.9075 , Val Loss: 1.1075, Train Dice: mode1 0.8350 mode2 0.7608 ,LR: 0.000001
INFO: Epoch:[057/081], Train Loss: 0.9076 , Sup Loss 0.9076 , Val Loss: 1.1057, Train Dice: mode1 0.8355 mode2 0.7618 ,LR: 0.000001
INFO: Epoch:[058/081], Train Loss: 0.9076 , Sup Loss 0.9076 , Val Loss: 1.1084, Train Dice: mode1 0.8352 mode2 0.7609 ,LR: 0.000001
INFO: Epoch:[059/081], Train Loss: 0.9079 , Sup Loss 0.9079 , Val Loss: 1.1148, Train Dice: mode1 0.8337 mode2 0.7638 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6912,valid_dice_m2_3d:0.5805
INFO: Epoch:[060/081], Train Loss: 0.9079 , Sup Loss 0.9079 , Val Loss: 1.1120, Train Dice: mode1 0.8353 mode2 0.7616 ,LR: 0.000001
INFO: Epoch:[061/081], Train Loss: 0.9071 , Sup Loss 0.9071 , Val Loss: 1.1070, Train Dice: mode1 0.8358 mode2 0.7625 ,LR: 0.000001
INFO: Epoch:[062/081], Train Loss: 0.9080 , Sup Loss 0.9080 , Val Loss: 1.1069, Train Dice: mode1 0.8323 mode2 0.7624 ,LR: 0.000001
INFO: Epoch:[063/081], Train Loss: 0.9083 , Sup Loss 0.9083 , Val Loss: 1.1075, Train Dice: mode1 0.8334 mode2 0.7593 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.7028,valid_dice_m2_3d:0.5845
INFO: Epoch:[064/081], Train Loss: 0.9079 , Sup Loss 0.9079 , Val Loss: 1.1034, Train Dice: mode1 0.8345 mode2 0.7602 ,LR: 0.000001
INFO: Epoch:[065/081], Train Loss: 0.9077 , Sup Loss 0.9077 , Val Loss: 1.1059, Train Dice: mode1 0.8340 mode2 0.7621 ,LR: 0.000001
INFO: Epoch:[066/081], Train Loss: 0.9088 , Sup Loss 0.9088 , Val Loss: 1.1037, Train Dice: mode1 0.8326 mode2 0.7614 ,LR: 0.000001
INFO: Epoch:[067/081], Train Loss: 0.9077 , Sup Loss 0.9077 , Val Loss: 1.1007, Train Dice: mode1 0.8355 mode2 0.7607 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6917,valid_dice_m2_3d:0.5797
INFO: Epoch:[068/081], Train Loss: 0.9070 , Sup Loss 0.9070 , Val Loss: 1.1112, Train Dice: mode1 0.8359 mode2 0.7630 ,LR: 0.000001
INFO: Epoch:[069/081], Train Loss: 0.9077 , Sup Loss 0.9077 , Val Loss: 1.1084, Train Dice: mode1 0.8357 mode2 0.7615 ,LR: 0.000001
INFO: Epoch:[070/081], Train Loss: 0.9071 , Sup Loss 0.9071 , Val Loss: 1.1087, Train Dice: mode1 0.8356 mode2 0.7590 ,LR: 0.000001
INFO: Epoch:[071/081], Train Loss: 0.9081 , Sup Loss 0.9081 , Val Loss: 1.1121, Train Dice: mode1 0.8339 mode2 0.7610 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6902,valid_dice_m2_3d:0.5776
INFO: Epoch:[072/081], Train Loss: 0.9084 , Sup Loss 0.9084 , Val Loss: 1.1122, Train Dice: mode1 0.8335 mode2 0.7624 ,LR: 0.000001
INFO: Epoch:[073/081], Train Loss: 0.9074 , Sup Loss 0.9074 , Val Loss: 1.1131, Train Dice: mode1 0.8359 mode2 0.7622 ,LR: 0.000001
INFO: Epoch:[074/081], Train Loss: 0.9081 , Sup Loss 0.9081 , Val Loss: 1.1046, Train Dice: mode1 0.8336 mode2 0.7616 ,LR: 0.000001
INFO: Epoch:[075/081], Train Loss: 0.9077 , Sup Loss 0.9077 , Val Loss: 1.0988, Train Dice: mode1 0.8350 mode2 0.7604 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6955,valid_dice_m2_3d:0.5868
INFO: Epoch:[076/081], Train Loss: 0.9078 , Sup Loss 0.9078 , Val Loss: 1.1077, Train Dice: mode1 0.8349 mode2 0.7614 ,LR: 0.000001
INFO: Epoch:[077/081], Train Loss: 0.9087 , Sup Loss 0.9087 , Val Loss: 1.1094, Train Dice: mode1 0.8336 mode2 0.7604 ,LR: 0.000001
INFO: Epoch:[078/081], Train Loss: 0.9066 , Sup Loss 0.9066 , Val Loss: 1.1068, Train Dice: mode1 0.8363 mode2 0.7626 ,LR: 0.000001
INFO: Epoch:[079/081], Train Loss: 0.9080 , Sup Loss 0.9080 , Val Loss: 1.1072, Train Dice: mode1 0.8337 mode2 0.7615 ,LR: 0.000001
INFO: valid_dice_m1_3d:0.6861,valid_dice_m2_3d:0.5723
INFO: Epoch:[080/081], Train Loss: 0.9071 , Sup Loss 0.9071 , Val Loss: 1.1152, Train Dice: mode1 0.8351 mode2 0.7623 ,LR: 0.000001
INFO: Model saved !
INFO: Train finished time: 2025-08-22 21:24:26
INFO: Time consuming : 13.50 min in train and test
